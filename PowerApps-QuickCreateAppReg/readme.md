# Azure AD Application Registration Script for Dataverse

This PowerShell script automates the creation of an Azure AD application registration and associated service principal for use with Dataverse. It handles the setup of required permissions and generates a client secret, facilitating easier integration and management of Azure AD applications.

## Features

- **Automatic Module Management:** Ensures the Microsoft.Graph module is installed and updated.
- **Application Registration:** Creates a new Azure AD application with the specified name.
- **Service Principal Creation:** Automatically generates a service principal for the newly created application.
- **Permission Handling:** Configures necessary permissions for Dataverse.
- **Client Secret Generation:** Creates and displays a new client secret.

## Prerequisites

Before you run this script, you need to have PowerShell installed and have administrative access to your Azure AD environment. Ensure that you can execute scripts by setting your PowerShell execution policy appropriately, if not already configured:
```powershell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```
## Installation

1. **Clone the repository or download the script:**

   You can clone the repository using Git or simply download the `.ps1` file to your local machine.

2. **Ensure dependencies are installed:**

   The script will automatically check for and install the `Microsoft.Graph` PowerShell module. If running the script for the first time, you may be prompted to install the module.

## Usage

To run the script, open PowerShell and navigate to the directory containing the script. Execute the script with the required parameters:
```powershell
.\CreateAppRegistration.ps1 -AppName "YourApplicationName"
```
### Parameters

- **AppName** (required): Specifies the display name for the Azure AD application.
- **StayConnected** (optional): Keeps the connection to Microsoft Graph active after script execution. Useful for continuous operations or troubleshooting.

## Example

To create an app registration with the name "MyDataverseApp" and disconnect from Microsoft Graph afterwards:
```powershell
.\CreateAppRegistration.ps1 -AppName "MyDataverseApp"
```
To create an app registration and maintain the connection:
```powershell
.\CreateAppRegistration.ps1 -AppName "MyDataverseApp" -StayConnected
```
## Additional Information

- **Client Secret:** The client secret generated by this script is output to the console. Ensure you store this secret securely as it is required for authentication by your application.
- **Disconnecting:** If you choose not to disconnect after the script runs, remember to manually disconnect using Disconnect-MgGraph to secure your session.

## Contributing

Contributions to the script are welcome. Please fork the repository, make your changes, and submit a pull request for review.

## License

This script is provided as-is under the [MIT License](../LICENSE). You are free to use, modify, and distribute it subject to the terms of the license.

## Support

For support and feature requests, please raise an issue in the GitHub repository.

---

**Note:** This script requires administrative rights to Microsoft Graph and Azure AD to function correctly. Please ensure you have the necessary permissions before running the script.
